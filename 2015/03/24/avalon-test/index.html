<!DOCTYPE html>
<html>

<head>
  <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" >
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
  <title>使用gulp搭建基于avalon的项目基础 | 柏小生</title>
  <meta name="description" content="柏小生的博客" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="MobileOptimized" content="320" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link href="/favicon.ico" rel="icon" type="image/x-ico">
  <link rel="stylesheet" type="text/css" href="/css/screen.css" />
  <link rel="stylesheet" type="text/css" href="/css/style.css" />
  <meta name="generator" content="柏小生">

  
  
  

  
</head>

<!--
<body class="post-template">
-->
<body class="home-template">
<div id="perspective" class="perspective effect-movedown">
  <div class="container">
    <!-- wrapper -->
    <div class="wrapper">

      <header class="site-head"  style="background: #24282b url(/img/img-bg.jpg) 0 -20%" >
    <div class="vertical">
        <div class="site-head-content inner">
             <a class="blog-logo" href="/"><img src="/img/logo.png" alt="Blog Logo"/></a> 
            <h1 class="blog-title">柏小生</h1>
            <h2 class="blog-description">柏小生的博客<button id="showMenu">菜单栏</button></h2>
        </div>
    </div>
</header>

      

<main class="content" role="main">
  <article class="post">
    <span class="post-meta">
      <time datetime="2015-03-24T02:50:57.197Z" itemprop="datePublished">
          2015年3月24日
      </time>
    
</span>
    <h1 class="post-title">使用gulp搭建基于avalon的项目基础</h1>
    <section class="post-content">
      <p>此项目是根据本人公司项目的要求搭建的，也许适用于很多其他的大部分项目。</p>
<h4 id="准备好gulp环境">准备好gulp环境</h4>
<p>首先可以使用<a href="https://github.com/gulpjs/gulp" target="_blank" rel="external">gulp</a>创建项目，配置一下gulpfile.js文件</p>
<p>下面是我自己的gulpfile.js文件</p>
<p>//包含gulp<br>var gulp = require(‘gulp’);</p>
<p>//包含我们的插件<br>var jshint = require(‘gulp-jshint’);<br>var minifyCss = require(‘gulp-minify-css’);<br>var minifyHTML = require(‘gulp-minify-html’);<br>var uglify = require(‘gulp-uglify’);<br>var imagemin = require(‘gulp-imagemin’);<br>var del = require(‘del’);<br>var path = {<br>  jshintsrcjspath: [‘./build/<strong>/*.js’, ‘!./build/</strong>/<em>.min.js’, ‘!./build/<strong>/libs/</strong>/</em>.js’, ‘!./build/<strong>/avalon.mobile.js’],<br>  srcjspath: [‘./build/</strong>/<em>.js’, ‘!./build/**/</em>.min.js’, ‘!./build/<strong>/avalon.mobile.js’],<br>  srccsspath: [‘./build/</strong>/<em>.css’, ‘!./build/**/</em>.min.css’],<br>  srcimagespath: [‘./build/<strong>/</strong>/<em>.png’],<br>  srccopypath: [‘./build/**/</em>.min.js’, ‘./build/<strong>/*.ico’, ‘./build/</strong>/<em>.txt’, ‘./build/<strong>/</strong>/</em>.jpg’],<br>  srchtmlpath: [‘./build/<em>*/</em>.html’],<br>  distpath: ‘./assets’<br>};<br>gulp.task(‘clean’, function (cb) {<br>  // You can use multiple globbing patterns as you would with <code>gulp.src</code><br>  del([‘./assets’], cb);<br>});<br>//lint task<br>gulp.task(‘jshint’, function () {<br>  gulp.src(path.jshintsrcjspath)<br>    .pipe(jshint())<br>    .pipe(jshint.reporter(‘default’));<br>});<br>//编译sass<br>/<em>gulp.task(‘compass’, function () {<br> gulp.src(srcscsspath)<br> .pipe(compass({<br> comments: false,<br> css: ‘../assets/css’,<br> sass: ‘scss’,<br> image: ‘images’<br> }))<br> .pipe(minifyCss({keepSpecialComments: 0}))//keepSpecialComments保持所有特殊注解<br> .pipe(rename({ extname: ‘.min.css’ }))<br> .pipe(gulp.dest(‘./assets/css’));<br> });</em>/<br>gulp.task(‘minifycss’, function () {<br>  return gulp.src(path.srccsspath)      //压缩的文件<br>    .pipe(minifyCss())             //执行压缩<br>    .pipe(gulp.dest(path.distpath));  //输出文件夹;<br>});<br>// 拷贝静态的图片<br>gulp.task(‘images’, function () {<br>  return gulp.src(path.srcimagespath)<br>    // Pass in options to the task<br>    .pipe(imagemin({optimizationLevel: 7}))<br>    .pipe(gulp.dest(path.distpath));<br>});</p>
<p>//压缩单个JS文件<br>gulp.task(‘uglifyjs’, function () {<br>  gulp.src(path.srcjspath)<br>    /<em> .pipe(rename({ extname: ‘.min.js’ }))</em>/<br>    .pipe(uglify())<br>    .pipe(gulp.dest(path.distpath));<br>});<br>gulp.task(‘copy’, function () {<br>  gulp.src(path.srccopypath)<br>    .pipe(gulp.dest(path.distpath));<br>});</p>
<p>//拷贝html<br>gulp.task(‘html’, function () {<br>  gulp.src(path.srchtmlpath)<br>    .pipe(minifyHTML({<br>      conditionals: true,<br>      spare: true<br>    }))<br>    .pipe(gulp.dest(path.distpath));<br>});<br>//拼接、简化JS文件<br>/<em>gulp.task(‘scripts’, function () {<br> gulp.src(srcjspath)<br> .pipe(concat(‘all.js’))<br> .pipe(gulp.dest(‘./assets/js’))<br> .pipe(rename(‘all.min.js’))<br> .pipe(uglify())<br> .pipe(gulp.dest(distpath));<br> });</em>/<br>gulp.task(‘all’, [‘clean’], function () {<br>  gulp.run([‘jshint’, ‘minifycss’, ‘uglifyjs’, ‘images’, ‘html’, ‘copy’]);<br>});<br>gulp.task(‘watch’, function () {<br>  gulp.watch(path.srcjspath, [‘uglifyjs’]);<br>  gulp.watch(path.srccsspath, [‘minifycss’]);<br>  gulp.watch(path.srchtmlpath, [‘html’]);<br>});<br>//默认任务<br>gulp.task(‘default’, [‘watch’, ‘all’]);</p>
<p>使用命令安装gulp插件</p>
<p>npm install gulp gulp-jshint gulp-minify-css gulp-uglify gulp-imagemin del gulp-minify-html —save-dev</p>
<h4 id="项目目录">项目目录</h4>
<p>我的项目目录是这样：</p>
<p>==build        //项目构建目录<br> | html        //html文件目录<br> | images      //图片文件目录<br> | javascripts //javascript文件目录<br> | stylesheets //样式文件目录</p>
<p> ==assets      //项目生成目录<br> | html        //html文件目录<br> | images      //图片文件目录<br> | javascripts //javascript文件目录<br> | stylesheets //样式文件目录</p>

    </section>
    <footer class="post-footer">
      <section class="author">
    <h4>baixiaosheng</h4>
    <p></p>
</section>
      <section class="share">
    <h5>分享这篇文章</h5>
    <a class="icon-sina-weibo" href="http://v.t.sina.com.cn/share/share.php?title= ?url=http://yoursite.com/2015/03/24/avalon-test/" target="_blank">
        <span class="hidden">weibo</span>
    </a>
</section>

    </footer>
  </article>
  <nav class="pagination" role="pagination">
    
    <span class="icon-logo">•</span>
    
    <a class="older-posts" href="/2015/01/21/hello-world/">
        Hello World →
    </a>
    
</nav>

  <div id="comment" class="comments-area">
    <h4 class="title"><a href="#disqus_comments" name="disqus_comments">Comments</a></h4>
    
</div>

</main>


      
<footer class="site-footer">
  
  <div class="inner">
     <section class="copyright">All content copyright <a href="/">柏小生</a> &copy; 2015 &bull; All rights reserved.</section>
  </div>
</footer>

      <script src="http://cdn.bootcss.com/jquery/1.11.2/jquery.min.js"></script>

<script type="text/javascript" src="/js/jquery.fitvids.js"></script>
<script type="text/javascript" src="/js/index.js"></script>
<script type="text/javascript" src="/js/menu.js"></script>





  </div>
</div>

<nav  class="outer-nav top horizontal">

          <a class="icon-home"  href="/"><span>主页</span></a>

</nav>

</div>
</body>
</html>
